class e{static replaceRange(e,t,n,s){return e.substring(0,t)+s+e.substring(n)}}class t{}class n extends t{transform(t,n){const s=t.matchAll(/--[\w-]+(?=\s*: ?.+;)/g);let r=0;for(const a of s){const s=a[0],o=a.index-r,i=n.transform(s),l=e.replaceRange(t,o,o+s.length,`--${i}`);r+=t.length-l.length,t=l}return t}}class s{}class r extends s{transform(t,n){const s=t.matchAll(/(?<="|')--[\w-]+(?=\\?\"|')/g),r=t.matchAll(/(?<=var\()[^()]*(?:\([^\)]*\)[^()]*)*(?=\))/g);let a=0;for(const r of s){const s=r[0],o=r.index-a,i=e.replaceRange(t,o,o+s.length,n.CSSVariableOf(s));a+=t.length-i.length,t=i}for(const s of r){const r=s[0].matchAll(/--[\w-]+/g),o=s.index;for(const s of r){const r=s[0],i=o+s.index-a,l=e.replaceRange(t,i,i+r.length,n.CSSVariableOf(r));a+=t.length-l.length,t=l}}return t}}class a{constructor(){this.count=0,this.chars="abcdefghijklmnopqrstuvwxyz",this.cache=new Map}createName(e=this.count++){let t="",n=this.chars.length;for(;e>=0&&(t=this.chars[e%n]+t,e>0);)e=Math.floor(e/n)-1;return t}transform(e){let t=this.cache.get(e);return t?(t.referenceCount+=1,t.identifierName):(this.cache.set(e,{originName:e,identifierName:this.createName(),referenceCount:0}),this.cache.get(e).identifierName)}CSSVariableOf(e){return this.cache.get(e)?`--${this.transform(e)}`:e}printLogs(){console.log(this.cache)}printLogsUnused(){for(const e of this.cache.values())0==e.referenceCount&&console.log(`${e.originName} is not referenced.`)}}class o{constructor(e){var t,s;this.options=e,this.transpilers=[],(null===(s=null===(t=null==e?void 0:e.mangle)||void 0===t?void 0:t.variable)||void 0===s||s)&&this.transpilers.push({declaration:new n,reference:new r,mangler:new a})}apply(e){e.hooks.compilation.tap("CSSMangleWebpackPlugin",(t=>{t.hooks.processAssets.tap({name:"CSSMangleWebpackPlugin",stage:e.webpack.Compilation.PROCESS_ASSETS_STAGE_OPTIMIZE},(n=>{var s,r,a,o;for(const s in n)if(s.endsWith(".html")||s.endsWith(".js")||s.endsWith(".jsx")||s.endsWith(".css"))for(const r of this.transpilers){const a=n[s].source().toString(),o=r.declaration.transform(a,r.mangler),i=r.reference.transform(o,r.mangler);t.updateAsset(s,new e.webpack.sources.RawSource(i))}null!==(r="all"==(null===(s=this.options)||void 0===s?void 0:s.printLogs))&&void 0!==r&&r&&this.transpilers.forEach((e=>e.mangler.printLogs())),null!==(o="warning"==(null===(a=this.options)||void 0===a?void 0:a.printLogs))&&void 0!==o&&o&&this.transpilers.forEach((e=>e.mangler.printLogsUnused()))}))}))}}export{n as CSSVariableDeclaration,r as CSSVariableReference,a as Mangler,t as ManglerDeclaration,s as ManglerReference,o as default};
