!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e="undefined"!=typeof globalThis?globalThis:e||self).CSSMangleWebpackPlugin={})}(this,(function(e){"use strict";class t{static replaceRange(e,t,n,s){return e.substring(0,t)+s+e.substring(n)}}class n{constructor(){this.count=0,this.chars="abcdefghijklmnopqrstuvwxyz",this.cache=new Map}static get instance(){var e;return null!==(e=this._instance)&&void 0!==e?e:this._instance=new n}createName(e=this.count++){let t="",n=this.chars.length;for(;e>=0&&(t=this.chars[e%n]+t,e>0);)e=Math.floor(e/n)-1;return t}transform(e){var t;return null!==(t=this.cache[e])&&void 0!==t?t:this.cache[e]=this.createName()}CSSVariableOf(e){return this.cache[e]?`--${this.transform(e)}`:e}}class s{}class a extends s{transform(e){const s=e.matchAll(/--[\w-]+(?=\s*: ?.+;)/g);let a=0;for(const r of s){const s=r[0],o=r.index-a,l=n.instance.transform(s),c=t.replaceRange(e,o,o+s.length,`--${l}`);a+=e.length-c.length,e=c}return e}}class r{}class o extends r{transform(e){const s=e.matchAll(/(?<="|')--[\w-]+(?="|')/g),a=e.matchAll(/(?<=var\()[^()]*(?:\([^\)]*\)[^()]*)*(?=\))/g);let r=0;for(const a of s){const s=a[0],o=a.index-r,l=t.replaceRange(e,o,o+s.length,n.instance.CSSVariableOf(s));r+=e.length-l.length,e=l}for(const s of a){const a=s[0].matchAll(/--[\w-]+/g),o=s.index;for(const s of a){const a=s[0],l=o+s.index-r,c=t.replaceRange(e,l,l+a.length,n.instance.CSSVariableOf(a));r+=e.length-c.length,e=c,console.log("global: ",o),console.log("local",s.index)}}return e}}e.CSSVariableDeclaration=a,e.CSSVariableReference=o,e.Mangler=n,e.ManglerDeclaration=s,e.ManglerReference=r,e.default=class{constructor(e){var t,n;this.options=e,this.transpilers=[],(null===(n=null===(t=null==e?void 0:e.mangle)||void 0===t?void 0:t.staticVariable)||void 0===n||n)&&this.transpilers.push({declaration:new a,reference:new o})}apply(e){e.hooks.compilation.tap("CSSMangleWebpackPlugin",(t=>{t.hooks.processAssets.tap({name:"CSSMangleWebpackPlugin",stage:e.webpack.Compilation.PROCESS_ASSETS_STAGE_OPTIMIZE},(n=>{for(const s in n)if(s.endsWith(".html")||s.endsWith(".js")||s.endsWith(".jsx")||s.endsWith(".css"))for(const a of this.transpilers){const r=n[s].source().toString(),o=a.declaration.transform(r),l=a.reference.transform(o);t.updateAsset(s,new e.webpack.sources.RawSource(l))}}))}))}},Object.defineProperty(e,"__esModule",{value:!0})}));
